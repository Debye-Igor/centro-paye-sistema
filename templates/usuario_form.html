{% extends "base.html" %}

{% block title %}Nuevo Usuario - Centro Paye{% endblock %}
{% block page_title %}Nuevo Usuario{% endblock %}

{% block content %}
<div class="content">
    <h2>Crear Usuario del Sistema</h2> <br>

    <form method="POST">
        <div class="form-group">
            <label for="nombre">Nombre *</label>
            <input type="text" id="nombre" name="nombre" required>
        </div>

        <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" required>
        </div>

        <div class="form-group">
            <label for="password">Contrase√±a *</label>
            <input type="password" id="password" name="password" required>
        </div>

        <div class="form-group">
            <label for="rol">Rol *</label>
            <select id="rol" name="rol" required onchange="mostrarEspecialidades()">
                <option value="">Seleccionar</option>
                <option value="administrador">Administrador</option>
                <option value="profesional">Profesional</option>
            </select>
        </div>

        <div class="form-group" id="especialidad-group" style="display: none;">
            <label for="especialidad_id">Especialidad *</label>
            <select id="especialidad_id" name="especialidad_id">
                <option value="">Seleccionar especialidad</option>
                {% for especialidad in especialidades %}
                <option value="{{ especialidad.id }}">{{ especialidad.codigo }} - {{ especialidad.nombre }}</option>
                {% endfor %}
            </select>
        </div>

        <button type="submit" class="btn-primary">Crear</button>
        <a href="{{ url_for('usuarios.usuarios') }}" class="btn-secondary">Cancelar</a>
    </form>
</div>

<script>
function mostrarEspecialidades() {
    const rol = document.getElementById('rol').value;
    const especialidadGroup = document.getElementById('especialidad-group');
    const especialidadSelect = document.getElementById('especialidad_id');
    
    if (rol === 'profesional') {
        especialidadGroup.style.display = 'block';
        especialidadSelect.required = true;
    } else {
        especialidadGroup.style.display = 'none';
        especialidadSelect.required = false;
        especialidadSelect.value = ''; 
    }
}
</script>

{% endblock %}